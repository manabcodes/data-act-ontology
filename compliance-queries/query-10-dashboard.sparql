# BONUS: Compliance Dashboard
# Summary of all B2B agreements with compliance status
# Provides overview of entire agreement portfolio

PREFIX dataact: <http://www.semanticweb.org/dataact#>
PREFIX dpv: <https://w3c.github.io/dpv/2.2/dpv/#>

SELECT ?agreement ?recipient ?price ?hasAuth ?isFRAND
WHERE {
  # Get all B2B agreements
  ?agreement a dataact:B2BDataSharing ;
             dataact:governedBy ?contract .
  
  ?contract dataact:compensationAmount ?price .
  
  # Get recipient
  OPTIONAL { 
    ?agreement dpv:hasRecipient ?recipient . 
  }
  
  # Check authorization
  BIND(EXISTS { ?agreement dataact:authorizedBy ?user } AS ?hasAuth)
  
  # Check FRAND compliance
  OPTIONAL {
    ?contract dataact:subjectToFRAND ?frand .
    ?frand dataact:isFair ?fair ;
           dataact:isReasonable ?reasonable ;
           dataact:isNonDiscriminatory ?nonDiscrim .
    BIND((?fair && ?reasonable && ?nonDiscrim) AS ?isFRAND)
  }
}
ORDER BY ?price