# BONUS: All Violations Report
# Find all types of violations in the dataset
# Comprehensive violation detection across all compliance checks

PREFIX dataact: <http://www.semanticweb.org/dataact#>
PREFIX dpv: <https://w3c.github.io/dpv/2.2/dpv/#>

SELECT DISTINCT ?violationType ?agreement ?details
WHERE {
  {
    # Violation 1: Missing authorization
    ?agreement a dataact:B2BDataSharing .
    FILTER NOT EXISTS { ?agreement dataact:authorizedBy ?user }
    BIND("Missing User Authorization (Art 8.4)" AS ?violationType)
    BIND(?agreement AS ?details)
  }
  UNION
  {
    # Violation 2: Unfair FRAND
    ?agreement a dataact:B2BDataSharing ;
               dataact:governedBy ?contract .
    ?contract dataact:subjectToFRAND ?frand .
    ?frand dataact:isFair false .
    BIND("Unfair FRAND Terms (Art 8.1)" AS ?violationType)
    BIND(?frand AS ?details)
  }
  UNION
  {
    # Violation 3: Non-discriminatory pricing
    ?agreement a dataact:B2BDataSharing ;
               dataact:governedBy ?contract .
    ?contract dataact:subjectToFRAND ?frand .
    ?frand dataact:isNonDiscriminatory false .
    BIND("Discriminatory Pricing (Art 8.3)" AS ?violationType)
    BIND(?frand AS ?details)
  }
  UNION
  {
    # Violation 4: Non-machine-readable data
    ?data dataact:isMachineReadable false .
    BIND("Non-Machine-Readable Data (Art 3.1)" AS ?violationType)
    BIND(?data AS ?details)
  }
}
ORDER BY ?violationType